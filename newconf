def run(self) -> None:
    """
    Execute the main workflow with current timestamp and user.
    Current Date and Time (UTC): 2025-03-09 20:23:15
    Current User's Login: satish537
    """
    try:
        # Load and process data
        df_top4 = self.load_and_process_data()
        
        # Generate content with combined table and chart
        table_and_chart = self.generate_table_and_chart(df_top4)
        
        content = f"""
        <h1>Overall Monthly Task Usage Report</h1>
        <p><strong>Last updated:</strong> 2025-03-09 20:23:15 UTC</p>
        <p><strong>Generated by:</strong> satish537</p>
        
        <h2>Task Usage Analysis</h2>
        {table_and_chart}
        
        <hr/>
        <p><em>Note: This report shows the top 4 dates with highest total jobs compared to baseline ({1899206:,}).</em></p>
        """
        
        # Get page info and update/create
        page_id, version = self.get_page_info()
        self.create_or_update_page(content, page_id, version)
        logger.info("Successfully generated and uploaded report")

    except Exception as e:
        logger.error(f"Error in main workflow: {str(e)}")
        raise

def generate_table_and_chart(self, df: pd.DataFrame) -> str:
    """
    Generate combined table and chart macro for Confluence with specific column ordering
    and chart type as column.
    
    Current Date and Time (UTC): 2025-03-09 20:23:15
    Current User's Login: satish537
    """
    # Generate table rows with reordered columns and renamed headers
    table_rows = ["<tr><th>DATE</th><th>Baseline</th><th>Total Jobs</th></tr>"]
    
    for _, row in df.iterrows():
        table_rows.append(
            f"<tr><td>{row['DATE'].strftime('%Y-%m-%d')}</td>"
            f"<td>{row['Base Line']:,}</td>"
            f"<td>{row['TOTAL_JOBS']:,}</td></tr>"
        )
    
    # Combine table and chart with explicit column chart type
    return f"""
    <ac:structured-macro ac:name="table-chart">
        <ac:parameter ac:name="type">column</ac:parameter>
        <ac:parameter ac:name="is3d">true</ac:parameter>
        <ac:parameter ac:name="title">4th Peak of the Month</ac:parameter>
        <ac:parameter ac:name="legend">true</ac:parameter>
        <ac:parameter ac:name="dataorientation">vertical</ac:parameter>
        <ac:parameter ac:name="columns">Baseline,Total Jobs</ac:parameter>
        <ac:rich-text-body>
            <table class="wrapped">
                <colgroup>
                    <col/>
                    <col/>
                    <col/>
                </colgroup>
                <tbody>
                    {' '.join(table_rows)}
                </tbody>
            </table>
        </ac:rich-text-body>
    </ac:structured-macro>
    """
